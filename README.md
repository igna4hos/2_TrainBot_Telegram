# Telegram-бот для расчёта нормы воды, калорий и трекинга активности
### Колесников Игнат Евгеньевич
Вы можете сами опробовать бота, вбив в поиск в телеграме @goHealthMate_bot

1. Сначала я локально настраивал бота и в файле index.py код, который запускал в colab. Из файла удалены токены.
2. yandex_bot_start.py - это файл, который запущен на сервере. При локальном запуске скорость ответа гораздо быстрее.
3. В репозитории приложены также таблицы с данными. В информации о логах по воде и еде и пользователях заменены id людей.

При старте бота приложение здоровается с пользователем и предлагает ему настроить профиль.

<img width="2260" height="2340" alt="1start_bot" src="https://github.com/user-attachments/assets/2a17b86c-5731-4ec4-99bb-ae11dd7663b4" />

### Вот список всех доступных команд

/start – приветствие

/help – список команд

/set_profile – настройка профиля пользователя

/log_water <мл> – сохраняем объём выпитой воды

/log_food <название продукта> – записываем еду, которую вы съели

/log_workout <тип> <минуты> – фиксируем сожжённые калории

/check_progress – показывает, сколько воды и калорий потреблено, сожжено и сколько осталось до выполнения цели

/profile - информация об аккаунте

/stats – выводим графики потребления воды и съеденной еды

/tip – подсказки по здоровью

Команды check_progress и stats можно запрашивать через кнопки снизу
## /set_profile – настройка профиля пользователя
При настройке профиля мы указываем пол, вес, рост, минуты активности, цель по калориям. При этом в разделе пола и цели по калориям нам не нужно писать текстом ответ, за это отвечают кнопки под сообщениями. Для расчёта дневной нормы воды в миллиграммах мы массу тела умножаем на 30. Когда мы указываем автоматичекий рассчёт калорий, то для рассчёта количества калорий применяется формула Миффлина-Сан Жеора.
> Для мужчин: 10 * weight + 6.25 * height - 5 * age + 5

> Для женщин: 10 * weight + 6.25 * height - 5 * age - 161

<img width="2260" height="2340" alt="2set_profile" src="https://github.com/user-attachments/assets/7baf9f4f-56d5-401d-852c-76281a0bb2d9" />

## /log_water <мл> – сохраняем объём выпитой воды
<img src="https://github.com/user-attachments/assets/7cb063ca-7def-425c-9b30-3fe606446fb9" width="50%">

## /log_food <название продукта> – записываем еду, которую вы съели
В первую очередь мы обращаемся к OpenFoodFacts. С блюдами там тяжко, не всегда находит что надо, да и в целом большинства блюд нет. Поэтому вторым шагом мы идём в локальный файл, где есть ряд блюд и их калорийность. Можно даже не совсем точно указать название, поскольку применяется функция get_close_matches, которая находит наиболее похожую строку из списка. Если уже не сработал и поиск по файлу, то мы сами просим пользователя ввести калорийность блюда.

<img src="https://github.com/user-attachments/assets/fab3c3eb-730d-4513-8de2-b962ffd35cfa" width="40%">

Таблица caloric_products.csv
| id | product_name                | energy_kcal_100g |
|:---|:----------------------------|:-----------------|
| 1  | Яблоко                      | 52               |
| 2  | Бананы                      | 89               |
| 3  | Апельсины                   | 47               |
| 4  | Куриная грудка (вареная)   | 165              |
| 5  | Рис белый вареный           | 130              |
## /log_workout <тип> <минуты> – фиксируем сожжённые калории
У нас есть список доступных тренировок. Можно ошибиться в названии тренировки и она всё равно найдётся благодаря поиску через get_close_matches. В зависимости от затраченного время на тренировку будет рекомендоваться какой объём воды нужно выпить. Мы получаем также погоду в вашем городе через OpenWeatherMap и если на улице жарко, то это также влияет на объём рекомендуемой воды.

<img src="https://github.com/user-attachments/assets/3c5f2117-91ce-44cd-9c2d-fefb5642ecea" width="40%">

Таблица caloric_products.csv
| id | train_type         | calorie_consumption | water_train | water_add_heat |
|----|--------------------|---------------------|-------------|----------------|
| 1  | Бег                | 680                 | 650         | 300            |
| 2  | Быстрая ходьба     | 350                 | 400         | 200            |
| 3  | Плавание           | 580                 | 450         | 250            |
| 4  | Велосипед          | 620                 | 600         | 450            |
| 5  | Силовая тренировка | 480                 | 500         | 250            |
## /check_progress – показывает, сколько воды и калорий потреблено, сожжено и сколько осталось до выполнения цели
# Дополнительный функционал
## /profile - информация об аккаунте
<img src="https://github.com/user-attachments/assets/26c3361d-6e28-480a-b546-7bf050f16193" width="50%">

## /stats – выводим графики потребления воды и съеденной еды
![IMG_20260115_134355_522](https://github.com/user-attachments/assets/2e1d93b2-567d-4aef-ac42-5300d88510f5)
![IMG_20260115_134354_664](https://github.com/user-attachments/assets/d54e5b9d-464a-4d0e-87a4-8edf6cc5458b)

## /tip – подсказки по здоровью
1. Если мы ещё не набрали за день нужные нам калории, то пользователю предлагается на выбор 3 полезных блюда, которые он может съесть. Каждый раз список позиций будет произвольным.
2. Если мы перебрали нашу норму, то будет предложена дополнительная тренировка в виде ходьбы и время, которое нужно потратить, чтобы избавиться от лишних калорий. Если мы превысили лимит в 500 калорий, то будет предложено заняться бегом, но не более 90 минут.

3. <img width="2260" height="2340" alt="tip_message" src="https://github.com/user-attachments/assets/d1037762-7f20-426d-bbf8-883680104a2f" />

Таблица health_food.csv
| id | product_name                          | energy_kcal_100g |
|:---|:--------------------------------------|-----------------:|
| 1  | Шпинат тушеный с чесноком            |               45 |
| 2  | Брокколи на пару с лимонным соком    |               38 |
| 3  | Цветная капуста запеченная с травами |               42 |
| 4  | Брюссельская капуста с бальзамиком   |               48 |
| 5  | Тушеная капуста с яблоком            |               52 |
# Деплой бота
Бот работает на платформе от яндекса. При запуске мы выводим номер версии и также каждую введённую от пользователя команду. Чтобы лушче понимать от кого пришло сообщение можно в логах отправлять id пользователя, но для сохранения данных намеренно отправляем только команду.
<img width="1624" height="710" alt="логи_яндекс" src="https://github.com/user-attachments/assets/a774b767-3a20-4394-8242-ef2d2c166d74" />

